 # Test for stdlib/pure/data/tree.lzscr
  # Inline tree definitions
  ~empty = .Leaf;
  ~is_empty = \(.Leaf) -> True | \(.Node _ _ _) -> False;
  ~insert_tree = \~cmp ~elem ~tree -> ((\.Leaf -> (.Node .Leaf ~elem .Leaf) | \(.Node ~left ~v ~right) -> (~ord = (~cmp ~elem ~v);
        ((\.LT -> (.Node (~insert_tree ~cmp ~elem ~left) ~v ~right) | \.EQ -> (.Node ~left ~elem ~right) | \.GT -> (.Node ~left ~v (~insert_tree ~cmp ~elem ~right))) ~ord))) ~tree);
  ~find = \~cmp ~elem ~tree -> ((\.Leaf -> None | \(.Node ~left ~v ~right) -> (~ord = (~cmp ~elem ~v);
        ((\.LT -> (~find ~cmp ~elem ~left) | \.EQ -> (Some ~v) | \.GT -> (~find ~cmp ~elem ~right)) ~ord))) ~tree);
  ~contains = \~cmp ~elem ~tree -> (~result = (~find ~cmp ~elem ~tree);
    ((\(Some ~_) -> True | \_ -> False) ~result));
  ~size = \~tree -> ((\.Leaf -> 0 | \(.Node ~left ~_ ~right) -> (1 + (~size ~left) + (~size ~right))) ~tree);
  # Comparison function for numbers
  ~cmp_num = \~a ~b -> (\(True -> .LT | \False -> (\(True -> .GT | \False -> .EQ) (~a > ~b))) (~a < ~b));
  # Helper
  ~and = \~a ~b -> (\(True -> ~b | \False -> False) ~a);
  # Test empty tree
  ~test_empty = (~t1 = ~is_empty ~empty;
    ~t2 = (~size ~empty) == 0;
    (~and ~t1 ~t2));
  # Test insert and find
  ~test_insert_find = (~tree1 = (~insert_tree ~cmp_num 5 ~empty);
    ~tree2 = (~insert_tree ~cmp_num 3 ~tree1);
    ~tree3 = (~insert_tree ~cmp_num 7 ~tree2);
    ~t1 = ~contains ~cmp_num 5 ~tree3;
    ~t2 = ~contains ~cmp_num 3 ~tree3;
    ~t3 = ~contains ~cmp_num 7 ~tree3;
    ~t4 = (\(True -> False | \False -> True) (~contains ~cmp_num 10 ~tree3));
    (~and ~t1 (~and ~t2 (~and ~t3 ~t4))));
  # Test size
  ~test_size = (~tree1 = (~insert_tree ~cmp_num 5 ~empty);
    ~tree2 = (~insert_tree ~cmp_num 3 ~tree1);
    ~tree3 = (~insert_tree ~cmp_num 7 ~tree2);
    ~tree4 = (~insert_tree ~cmp_num 1 ~tree3);
    ~t1 = (~size ~tree1) == 1;
    ~t2 = (~size ~tree2) == 2;
    ~t3 = (~size ~tree3) == 3;
    ~t4 = (~size ~tree4) == 4;
    (~and ~t1 (~and ~t2 (~and ~t3 ~t4))));
  # Run all tests
  ~all_tests = (~r1 = ~test_empty;
    ~r2 = ~test_insert_find;
    ~r3 = ~test_size;
    (~and ~r1 (~and ~r2 ~r3)));
  ~all_tests