# LazyScript (lzscr) Roadmap

最終更新: 2025-09-22

このドキュメントはロードマップの唯一の参照元です。実装コメントやREADMEの簡易記述は本書に従います（差異があれば本書を優先）。

## 現状と前提
- 対応範囲: 字句/構文/AST/評価器(一部ビルトイン)/型推論(HM rank-1)/Core IR 生成
- 安定度:
  - 安定: パーサ、基本評価、型推論の骨格、CLI 実行/ダンプ
  - 実験的: Core IR の実行、診断の二重ケアット、エフェクト `--strict-effects`
- 互換性ポリシー: 0.x 期間は内部 API 変更あり。CLI フラグは事前告知のうえ変更する場合があります。

## 直近の優先項目（Short-term）
- 診断の改善（継続）
  - 二重ケアット: 期待/実際・発生元/発見箇所の2点表示を標準化
  - レコード: フィールド名と値位置を指すスパンの徹底
  - occurs: 変数生成起点スパンの追跡、正規化表示（%a,%b…）
  - メッセージ英語化と簡潔化、Fix-it ヒント追加
- 型システムの整備
  - zonk の適用タイミングを明文化、最終出力の安定化
  - unify の重複ロジック整理（安全なヘルパ抽出）
- Core IR
  - Lower の堅牢化（例外/alt/catch の IR 表現を固定）
  - 小規模ケースの IR 実行（評価器 PoC）健全性向上

## 中期（Mid-term）
- 例外/代替ラムダの型付けと IR 統合（AltLambda/Catch）
- 名前解決とアップバリュー解析（静的解析拡充）
- エフェクトの型側連携（strict-effects を型に取り込む計画策定）

## 長期（Long-term）
- ADT 宣言とコンストラクタ検査、型クラス/カインド拡張の検討
- フォーマッタの安定化と VS Code 拡張の最小機能版公開
- 実行系の高速化（将来の LLVM/最適化は研究枠）

## 表示/診断ポリシー
- 可能な限り「原因と影響」を二重スパンで表示
- 行/列はキャレットヘッダで提示し、本文メッセージは簡潔に
- 先頭 `{` など曖昧な 1 文字スパンはヒューリスティックで内側の実体へ寄せる
